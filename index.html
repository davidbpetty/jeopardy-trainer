<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jeopardy Trainer (Local Demo)</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">JT</div>
      <div>
        <div class="title">Jeopardy Trainer</div>
        <div class="subtitle">Tap-to-buzz • Timed clues • Score like the show</div>
      </div>
    </div>

    <div class="status">
      <div class="pill">Score: <span id="score">0</span></div>
      <div class="pill">Clue <span id="clueIndex">0</span>/<span id="clueTotal">0</span></div>
      <div class="pill">Time: <span id="timeLeft">0.0</span>s</div>
      <button id="btnSettings" class="ghost">Settings</button>
    </div>
  </header>

  <main class="layout">
    <!-- GAME -->
    <section id="gameView" class="panel">
      <div class="boardHeader">
        <div class="meta">
          <div class="cat" id="category">—</div>
          <div class="val" id="value">$0</div>
        </div>
        <div class="meta2">
          <div class="roundName" id="roundName">Round 1</div>
          <div class="hint" id="hint">Tap anywhere to buzz when you know it</div>
        </div>
      </div>

      <div id="clueCard" class="clueCard" tabindex="0" role="button" aria-label="Tap to buzz">
        <div id="clueText" class="clueText">Press “Start Round”</div>
        <div id="blankOverlay" class="blankOverlay hidden">
          <div class="blankMsg">2 seconds to answer…</div>
        </div>
      </div>

      <div class="controls">
        <button id="btnStart" class="primary">Start Round</button>
        <button id="btnSkip" class="ghost" disabled>Skip</button>
        <button id="btnCorrect" class="good" disabled>Got it ✅</button>
        <button id="btnWrong" class="bad" disabled>Missed ❌</button>
      </div>

      <div class="smallRow">
        <div class="small">
          <div class="smallLabel">Read aloud</div>
          <label class="switch">
            <input id="ttsToggle" type="checkbox" checked />
            <span class="slider"></span>
          </label>
        </div>

        <div class="small">
          <div class="smallLabel">Buzz time limit</div>
          <select id="timeLimit">
            <option value="5">5s (Jeopardy-style)</option>
            <option value="6">6s</option>
            <option value="7">7s</option>
          </select>
        </div>

        <div class="small">
          <div class="smallLabel">Answer blank</div>
          <select id="blankTime">
            <option value="2000">2s</option>
            <option value="1500">1.5s</option>
            <option value="2500">2.5s</option>
          </select>
        </div>
      </div>

      <div class="footerNote">
        Import your own clue set (CSV/JSON) in Settings.
      </div>
    </section>

    <!-- LEARNING FEED -->
    <section id="learnView" class="panel hidden">
      <div class="learnHeader">
        <div>
          <div class="learnTitle">Review Feed</div>
          <div class="learnSubtitle">Fast 5-minute refreshers on weak topics</div>
        </div>
        <button id="btnNextRound" class="primary">Start Next Round</button>
      </div>

      <div id="summary" class="summary"></div>

      <div class="feedWrap">
        <div class="feedHint">Scroll vertically (snap cards). Each card is a 1–2 minute micro-lesson.</div>
        <div id="feed" class="feed"></div>
      </div>
    </section>
  </main>

  <!-- SETTINGS MODAL -->
  <dialog id="settingsModal" class="modal">
    <form method="dialog" class="modalInner">
      <div class="modalHeader">
        <div>
          <div class="modalTitle">Settings</div>
          <div class="modalSubtitle">Load your clue set and optionally enable AI summaries.</div>
        </div>
        <button class="ghost" value="cancel">Close</button>
      </div>

      <div class="grid">
        <div class="card">
          <div class="cardTitle">Import clue set</div>
          <div class="cardBody">
            <div class="muted">CSV columns:</div>
            <code>id,round,category,value,clue,response,subject_tags,source_url</code>
            <div class="muted">JSON: array of same fields.</div>
            <input id="fileInput" type="file" accept=".csv,.json" />
            <button id="btnLoadSample" class="ghost" type="button">Reload built-in sample</button>
            <div id="importStatus" class="muted"></div>
          </div>
        </div>

        <div class="card">
          <div class="cardTitle">AI lesson generation (optional)</div>
          <div class="cardBody">
            <div class="muted">
              If you supply an OpenAI API key, the feed cards will be generated per weak topic.
              Otherwise, the app uses a built-in template generator.
            </div>
            <label class="row">
              <span>OpenAI API key</span>
              <input id="openaiKey" type="password" placeholder="sk-..." autocomplete="off" />
            </label>
            <label class="row">
              <span>Model</span>
              <input id="openaiModel" type="text" value="gpt-4.1-mini" />
            </label>
            <label class="row">
              <span>Enable AI</span>
              <select id="aiEnable">
                <option value="0">Off</option>
                <option value="1">On (requires key)</option>
              </select>
            </label>
            <div class="muted">
              Note: running from <code>file://</code> blocks API calls. Use the local server steps below.
            </div>
          </div>
        </div>

        <div class="card">
          <div class="cardTitle">Round behavior</div>
          <div class="cardBody">
            <div class="muted">Next round includes: (a) some review from weak topics, (b) some new categories.</div>
            <label class="row">
              <span>Round length (clues)</span>
              <input id="roundLen" type="number" min="5" max="60" value="20" />
            </label>
            <label class="row">
              <span>Review ratio</span>
              <input id="reviewRatio" type="number" min="0" max="1" step="0.1" value="0.4" />
            </label>
          </div>
        </div>
      </div>

      <div class="modalFooter">
        <button class="ghost" value="cancel">Close</button>
      </div>
    </form>
  </dialog>

  <script type="module" src="./app.js"></script>
</body>
</html>