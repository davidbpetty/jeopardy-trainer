<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Jeopardy Trainer</title>
  <link rel="stylesheet" href="styles.css?v=2">
</head>
<body>
  <header class="topbar">
    <div class="brand">Jeopardy Trainer</div>

    <div class="scoreWrap">
      <div class="scoreLabel">Score</div>
      <div id="score" class="scoreValue">0</div>
    </div>

    <div class="topActions">
      <button id="btnNewBoard" class="btn">New Board</button>
      <button id="btnSettings" class="btn btnGhost">Settings</button>
    </div>
  </header>

  <main class="main">

    <!-- BOARD VIEW -->
    <section id="boardView" class="view">
      <div class="boardControls">
        <div class="control">
          <div class="controlLabel">Categories</div>
          <select id="categoriesCount" class="select">
            <option value="3">3</option>
            <option value="4" selected>4</option>
            <option value="5">5</option>
            <option value="6">6</option>
          </select>
        </div>

        <div class="control">
          <div class="controlLabel">Values</div>
          <div class="pill">200 • 400 • 600 • 800 • 1000</div>
        </div>

        <div class="control grow">
          <div id="statusLine" class="statusLine">Import a TSV in Settings, then tap New Board.</div>
        </div>
      </div>

      <div id="board" class="board"></div>
    </section>

    <!-- CLUE VIEW -->
    <section id="clueView" class="view hidden">
      <div class="clueHeader">
        <div>
          <div id="clueCategory" class="clueCategory">CATEGORY</div>
          <div id="clueValue" class="clueValue">$200</div>
        </div>
        <button id="btnBackToBoardTop" class="btn btnGhost">Back</button>
      </div>

      <div class="clueCard">
        <div id="clueText" class="clueText"></div>

        <div id="progressWrap" class="progressWrap hidden">
          <div class="progressBar"><div id="progressFill" class="progressFill"></div></div>
          <div id="progressLabel" class="progressLabel">Buzz window: 5.0s</div>
        </div>

        <button id="btnBuzz" class="btnBuzz hidden" aria-label="Buzz in">BUZZ</button>

        <div id="blankScreen" class="blankScreen hidden"></div>

        <div id="resultActions" class="resultActions hidden">
          <button id="btnGotIt" class="btn btnGood">Got it</button>
          <button id="btnMissed" class="btn btnBad">Missed</button>
        </div>

        <div id="noBuzzActions" class="noBuzzActions hidden">
          <button id="btnBackToBoard" class="btn">Back to Board</button>
        </div>
      </div>
    </section>

    <!-- RESULTS VIEW -->
    <section id="resultsView" class="view hidden">
      <div class="resultsTop">
        <div class="resultsTitle">Board Results</div>
        <button id="btnNewBoard2" class="btn">New Board</button>
      </div>

      <div id="resultsSummary" class="resultsSummary"></div>

      <div class="feedTitle">Missed + Skipped Review</div>
      <div id="feed" class="feed"></div>
    </section>

  </main>

  <!-- SETTINGS -->
  <dialog id="settingsModal" class="modal">
    <form method="dialog" class="modalBody">
      <div class="modalHeader">
        <div class="modalTitle">Settings</div>
        <button class="btn btnGhost" value="close">Close</button>
      </div>

      <div class="settingsGrid">
        <div class="settingBlock">
          <div class="settingTitle">Import dataset</div>
          <input id="fileInput" type="file" accept=".tsv,.csv,.json,.txt" />
          <div id="importStatus" class="importStatus">No import yet.</div>
          <div class="hint">TSV supported: jwolle1 seasons/seasonXX.tsv format.</div>
        </div>

        <div class="settingBlock">
          <div class="settingTitle">Reader</div>
          <hr style="border:none;border-top:1px solid rgba(255,255,255,.10);margin:12px 0;">

<label class="row">
  <input id="openaiTtsToggle" type="checkbox" />
  <span>Use OpenAI TTS (requires API key)</span>
</label>

<div class="row">
  <span class="rowLabel">API key</span>
  <input id="openaiApiKey" class="input" type="password" placeholder="sk-..." autocomplete="off" />
</div>

<div class="row">
  <span class="rowLabel">OpenAI voice</span>
  <select id="openaiVoiceSelect" class="select">
    <option value="alloy">alloy</option>
    <option value="ash">ash</option>
    <option value="ballad">ballad</option>
    <option value="coral">coral</option>
    <option value="echo">echo</option>
    <option value="fable">fable</option>
    <option value="onyx">onyx</option>
    <option value="nova">nova</option>
    <option value="sage">sage</option>
    <option value="shimmer">shimmer</option>
    <option value="verse">verse</option>
    <option value="marin">marin</option>
    <option value="cedar">cedar</option>
  </select>
</div>

<div class="hint">
  Key is stored only in this browser’s local storage (not committed to GitHub). Requests still send the key from your phone to OpenAI.
</div>
          <label class="row">
            <input id="ttsToggle" type="checkbox" checked />
            <span>Read clues aloud (system voice)</span>
          </label>

          <div class="row">
            <span class="rowLabel">Voice</span>
            <select id="voiceSelect" class="select"></select>
          </div>

          <div class="hint">
            ChatGPT-like voices require OpenAI Audio/TTS via API. Do not place API keys in browser apps.
          </div>
        </div>

        <div class="settingBlock">
          <div class="settingTitle">Timing</div>

          <div class="row">
            <span class="rowLabel">Buzz window (sec)</span>
            <input id="buzzWindowSec" class="input" type="number" min="1" max="15" step="0.5" value="5" />
          </div>

          <div class="row">
            <span class="rowLabel">Blank screen (ms)</span>
            <input id="blankMs" class="input" type="number" min="250" max="5000" step="250" value="2000" />
          </div>

          <div class="hint">
            Countdown starts only after reading finishes (speech end event + fallback estimate).
          </div>
        </div>

        <div class="settingBlock">
          <div class="settingTitle">Board rule</div>
          <div class="hint">Board pulls Round 1 clues with values 200–1000.</div>
        </div>
      </div>
    </form>
  </dialog>

  <script type="module" src="app.js?v=2"></script>
</body>
</html>