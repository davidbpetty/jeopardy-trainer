<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Jeopardy Trainer</title>
  <link rel="stylesheet" href="styles.css?v=7">
</head>
<body>
  <header class="topbar">
    <div class="brand">Jeopardy Trainer</div>

    <div class="scoreWrap">
      <div class="scoreLabel">Score</div>
      <div id="score" class="scoreValue">0</div>
    </div>

    <div class="topActions">
      <button id="btnNewBoard" class="btn">New Board</button>
      <button id="btnSettings" class="btn btnGhost" type="button">Settings</button>
    </div>
  </header>

  <main class="main">

    <!-- BOARD VIEW -->
    <section id="boardView" class="view">
      <div class="boardControls">
        <div class="control">
          <div class="controlLabel">Categories</div>
          <select id="categoriesCount" class="select">
            <option value="3">3</option>
            <option value="4" selected>4</option>
            <option value="5">5</option>
            <option value="6">6</option>
          </select>
        </div>

        <div class="control">
          <div class="controlLabel">Values</div>
          <div class="pill">200 • 400 • 600 • 800 • 1000</div>
        </div>

        <div class="control grow">
          <div id="statusLine" class="statusLine">Import a TSV in Settings, then tap New Board.</div>
        </div>
      </div>

      <div id="board" class="board"></div>
    </section>

    <!-- CLUE VIEW -->
    <section id="clueView" class="view hidden">
      <div class="clueHeader">
        <div>
          <div id="clueCategory" class="clueCategory">CATEGORY</div>
          <div id="clueValue" class="clueValue">$200</div>
        </div>
        <button id="btnBackToBoardTop" class="btn btnGhost" type="button">Back</button>
      </div>

      <div class="clueCard">
        <div id="clueText" class="clueText"></div>

        <div id="progressWrap" class="progressWrap hidden">
          <div class="progressBar"><div id="progressFill" class="progressFill"></div></div>
          <div id="progressLabel" class="progressLabel">Buzz window: 5.0s</div>
        </div>

        <button id="btnBuzz" class="btnBuzz hidden" aria-label="Buzz in" type="button">BUZZ</button>

        <div id="blankScreen" class="blankScreen hidden"></div>

        <div id="resultActions" class="resultActions hidden">
          <button id="btnGotIt" class="btn btnGood" type="button">Got it</button>
          <button id="btnMissed" class="btn btnBad" type="button">Missed</button>
        </div>

        <div id="noBuzzActions" class="noBuzzActions hidden">
          <button id="btnBackToBoard" class="btn" type="button">Back to Board</button>
        </div>
      </div>
    </section>

    <!-- RESULTS VIEW -->
    <section id="resultsView" class="view hidden">
      <div class="resultsTop">
        <div class="resultsTitle">Board Results</div>
        <button id="btnNewBoard2" class="btn" type="button">New Board</button>
      </div>

      <div id="resultsSummary" class="resultsSummary"></div>

      <div class="feedTitle">Missed + Skipped Review</div>
      <div id="feed" class="feed"></div>
    </section>

  </main>

  <!-- SETTINGS -->
  <dialog id="settingsModal" class="modal">
    <form method="dialog" class="modalBody">
      <div class="modalHeader">
        <div class="modalTitle">Settings</div>
        <button class="btn btnGhost" value="close" type="button">Close</button>
      </div>

      <div class="settingsGrid">
        <div class="settingBlock">
          <div class="settingTitle">Import dataset</div>
          <input id="fileInput" type="file" accept=".tsv,.csv,.json,.txt" />
          <div id="importStatus" class="importStatus">No import yet.</div>
          <div class="hint">TSV supported: jwolle1 seasons/seasonXX.tsv format.</div>
        </div>

        <div class="settingBlock">
          <div class="settingTitle">Reader</div>
          <hr style="border:none;border-top:1px solid rgba(255,255,255,.10);margin:12px 0;">

          <label class="row">
            <input id="ttsToggle" type="checkbox" checked />
            <span>Read clues aloud (system voice)</span>
          </label>

          <div class="row">
            <span class="rowLabel">Voice</span>
            <select id="voiceSelect" class="select"></select>
          </div>

          <hr style="border:none;border-top:1px solid rgba(255,255,255,.10);margin:14px 0;">

          <label class="row">
            <input id="elevenTtsToggle" type="checkbox" />
            <span>Use ElevenLabs TTS (requires API key)</span>
          </label>

          <div class="row">
            <span class="rowLabel">API key</span>
            <input id="elevenApiKey" class="input" type="password" placeholder="••••••••" autocomplete="off" />
          </div>

          <div class="row">
            <span class="rowLabel">Voice ID</span>
            <input id="elevenVoiceId" class="input" type="text" placeholder="e.g., JBFqnCBsd6RMkjVDRZzb" autocomplete="off" />
          </div>

          <div class="row">
            <span class="rowLabel">Model</span>
            <select id="elevenModelSelect" class="select">
              <option value="eleven_multilingual_v2" selected>eleven_multilingual_v2</option>
            </select>
          </div>

          <div class="row">
            <span class="rowLabel">Output</span>
            <select id="elevenOutputFormat" class="select">
              <option value="mp3_44100_128" selected>mp3_44100_128</option>
              <option value="mp3_22050_32">mp3_22050_32</option>
              <option value="pcm_24000">pcm_24000</option>
              <option value="ulaw_8000">ulaw_8000</option>
            </select>
          </div>

          <div class="hint">
            Key is stored only in this browser’s local storage (not committed to GitHub). Requests still send the key from your phone to ElevenLabs.
          </div>

          <div class="hint">
            If ElevenLabs is enabled and a key + voice ID are present, it will be used; otherwise the system voice is used.
          </div>
        </div>

        <div class="settingBlock">
          <div class="settingTitle">Timing</div>

          <div class="row">
            <span class="rowLabel">Buzz window (sec)</span>
            <input id="buzzWindowSec" class="input" type="number" min="1" max="15" step="0.5" value="5" />
          </div>

          <div class="row">
            <span class="rowLabel">Blank screen (ms)</span>
            <input id="blankMs" class="input" type="number" min="250" max="5000" step="250" value="2000" />
          </div>

          <div class="hint">
            Countdown starts only after reading finishes (TTS end + fallback estimate).
          </div>
        </div>

        <div class="settingBlock">
          <div class="settingTitle">Board rule</div>
          <div class="hint">Board pulls Round 1 clues with values 200–1000.</div>
        </div>
      </div>
    </form>
  </dialog>

  <script type="module" src="app.js?v=7"></script>
</body>
</html>